<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Marketing & Sales Â· Nova</title>
  <!-- Font & Icons (Inter + Feather) -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/feather-icons"></script>
  <!-- Firebase SDKs (modular) -->
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
  <style>
    /* -------------------- RESET / GLOBAL -------------------- */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: "Inter", -apple-system, BlinkMacSystemFont, sans-serif;
      background: radial-gradient(circle at 10% 20%, #f1f4f9, #e9ecf2);
      min-height: 100vh;
      display: flex;
      color: #1e1e2f;
      transition: background 0.2s;
      --glass: rgba(255,255,255,0.6);
      --glass-edge: rgba(255,255,255,0.8);
      --shadow-sm: 0 8px 20px -6px rgba(0,0,0,0.08), 0 0 0 1px rgba(0,0,0,0.02);
      --shadow-md: 0 20px 30px -10px rgba(0,20,40,0.2), 0 0 0 1px rgba(255,255,255,0.5);
      --accent: #2b6ef0;
      --accent-glow: rgba(43,110,240,0.3);
      --radius-card: 24px;
      --radius-input: 14px;
      --transition: all 0.25s cubic-bezier(0.2, 0, 0, 1);
    }
    /* Glass panel base */
    .glass, .sidebar, .topbar, .card, .modal-content, .dropdown-menu, .slide-panel {
      background: var(--glass);
      backdrop-filter: blur(20px) saturate(180%);
      -webkit-backdrop-filter: blur(20px) saturate(180%);
      border: 1px solid rgba(255,255,255,0.5);
      box-shadow: var(--shadow-sm);
    }
    /* App wrapper â€“ hides/shows via JS class */
    #app { display: flex; width: 100%; }
    /* auth container (centered) */
    .auth-container {
      min-height: 100vh; width: 100%;
      display: flex; align-items: center; justify-content: center;
      background: radial-gradient(circle at 30% 30%, #dee5ee, #cbd0da);
    }
    .auth-card { width: 400px; padding: 32px; border-radius: 40px; background: rgba(255,255,255,0.7); backdrop-filter: blur(20px); }
    /* main layout â€“ hidden until authenticated */
    .main-layout { display: flex; width: 100%; min-height: 100vh; }
    /* collapsible sidebar */
    .sidebar {
      width: 260px; transition: width 0.3s ease; padding: 20px 12px;
      display: flex; flex-direction: column; gap: 8px; border-radius: 0 28px 28px 0; margin: 10px 0 10px 0; height: calc(100vh - 20px);
    }
    .sidebar.collapsed { width: 80px; }
    .sidebar .logo-area { padding: 8px 12px 28px 12px; font-weight: 600; font-size: 18px; letter-spacing: -0.3px; display: flex; align-items: center; gap: 10px; }
    .sidebar.collapsed .logo-text { display: none; }
    .nav-item {
      display: flex; align-items: center; gap: 14px; padding: 12px 14px; border-radius: 18px;
      color: #1e1e2f; transition: var(--transition); cursor: pointer; margin: 2px 0; position: relative;
    }
    .nav-item i { width: 24px; }
    .sidebar.collapsed .nav-item span { display: none; }
    .nav-item.active {
      background: rgba(43,110,240,0.12); font-weight: 500;
      box-shadow: inset 0 0 0 1px rgba(43,110,240,0.2), 0 4px 8px -4px var(--accent-glow);
    }
    .nav-item.active::before {
      content: ''; position: absolute; left: 0; top: 20%; height: 60%; width: 4px;
      background: var(--accent); border-radius: 0 4px 4px 0; transform: scaleY(1); transition: transform 0.2s;
    }
    .nav-item:hover { background: rgba(255,255,255,0.7); transform: translateX(4px); }
    /* topbar */
    .topbar {
      padding: 12px 28px; border-radius: 40px; margin: 12px 24px 0 24px;
      display: flex; align-items: center; justify-content: space-between; backdrop-filter: blur(16px);
    }
    .page-title { font-size: 1.6rem; font-weight: 550; letter-spacing: -0.02em; }
    .topbar-actions { display: flex; gap: 24px; align-items: center; }
    .avatar { width: 44px; height: 44px; border-radius: 30px; background: #d0d8e8; cursor: pointer; }
    .dropdown { position: relative; }
    .dropdown-menu {
      position: absolute; right: 0; top: 50px; min-width: 180px; border-radius: 24px;
      padding: 8px; opacity: 0; visibility: hidden; transition: var(--transition); transform: scale(0.9);
      z-index: 1000;
    }
    .dropdown.open .dropdown-menu { opacity: 1; visibility: visible; transform: scale(1); }
    .dropdown-item { padding: 12px 16px; border-radius: 16px; transition: background 0.1s; cursor: pointer; }
    .dropdown-item:hover { background: rgba(0,0,0,0.04); }
    /* main content area */
    .main-area { flex: 1; display: flex; flex-direction: column; }
    .content-pane { padding: 28px 24px; overflow-y: auto; height: calc(100vh - 100px); }
    /* screens */
    .screen { display: none; animation: fadeSlide 0.3s ease; }
    .screen.active { display: block; }
    @keyframes fadeSlide { 0% { opacity: 0.5; transform: translateY(8px); } 100% { opacity: 1; transform: translateY(0); } }
    /* cards, inputs, buttons */
    .card { background: rgba(255,255,255,0.55); border-radius: var(--radius-card); padding: 20px; transition: var(--transition); }
    .card:hover { box-shadow: var(--shadow-md); transform: translateY(-2px); background: rgba(255,255,255,0.75); }
    .btn {
      border: none; background: rgba(255,255,255,0.8); padding: 10px 20px; border-radius: 40px;
      font-weight: 500; display: inline-flex; align-items: center; gap: 8px; transition: var(--transition);
      cursor: pointer; backdrop-filter: blur(4px); box-shadow: 0 2px 6px rgba(0,0,0,0.03);
    }
    .btn-primary { background: var(--accent); color: white; box-shadow: 0 8px 18px -6px var(--accent-glow); }
    .btn-primary:hover { background: #1a5be0; transform: scale(1.02); box-shadow: 0 12px 24px -8px var(--accent); }
    .btn-danger { background: #f43f5e; color: white; }
    .btn-icon { padding: 8px; border-radius: 30px; }
    input, select, textarea {
      border: 1px solid rgba(0,0,0,0.06); background: rgba(255,255,255,0.7); border-radius: var(--radius-input);
      padding: 14px 16px; font-size: 1rem; width: 100%; transition: var(--transition); backdrop-filter: blur(4px);
    }
    input:focus, select:focus, textarea:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 4px var(--accent-glow); background: white; }
    /* table */
    .table-wrapper { border-radius: 24px; overflow: auto; background: rgba(255,255,255,0.35); backdrop-filter: blur(4px); }
    table { width: 100%; border-collapse: collapse; }
    th { position: sticky; top: 0; background: rgba(255,255,255,0.7); backdrop-filter: blur(20px); font-weight: 500; padding: 16px 8px; }
    td { padding: 14px 8px; border-bottom: 1px solid rgba(0,0,0,0.03); }
    tr:hover td { background: rgba(255,255,255,0.4); }
    /* loading skeleton */
    .skeleton { background: linear-gradient(90deg, #f0f0f0 25%, #fafafa 50%, #f0f0f0 75%); background-size: 200% 100%; animation: loading 1.5s infinite; border-radius: 12px; height: 20px; }
    @keyframes loading { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
    /* toast */
    .toast-container { position: fixed; bottom: 24px; right: 24px; z-index: 9999; display: flex; flex-direction: column; gap: 12px; }
    .toast { background: rgba(255,255,255,0.9); backdrop-filter: blur(20px); border-radius: 60px; padding: 14px 24px; box-shadow: var(--shadow-md); border: 1px solid white; transform: translateX(120%); transition: all 0.3s ease; max-width: 320px; }
    .toast.show { transform: translateX(0); }
    .toast.success { border-left: 6px solid #10b981; }
    .toast.error { border-left: 6px solid #f43f5e; }
    /* modals */
    .modal-overlay { position: fixed; inset:0; background: rgba(0,0,0,0.1); backdrop-filter: blur(8px); display: none; place-items: center; z-index: 10000; }
    .modal-overlay.open { display: grid; }
    .modal-content { max-width: 500px; width: 90%; border-radius: 48px; padding: 28px; animation: scaleFade 0.2s; }
    @keyframes scaleFade { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
    /* lead slide panel */
    .slide-panel { position: fixed; right: 0; top: 0; width: 440px; height: 100vh; background: rgba(255,255,255,0.7); backdrop-filter: blur(30px); transform: translateX(100%); transition: transform 0.3s ease; padding: 28px; z-index: 1001; }
    .slide-panel.open { transform: translateX(0); }
    /* empty / error states */
    .empty-state, .error-state { text-align: center; padding: 48px; opacity: 0.8; }
    /* utility */
    .row { display: flex; gap: 20px; flex-wrap: wrap; }
    .grid-4 { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; }
    .hidden { display: none !important; }
  </style>
</head>
<body>
<div id="app"></div>
<script>
  (function() {
    // -------------------- FIREBASE INIT (keep existing mock) --------------------
    const firebaseConfig = {
      apiKey: "AIzaSyDummy",
      authDomain: "dummy.firebaseapp.com",
      projectId: "dummy",
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // ---------- GLOBAL STATE ----------
    let currentUser = null;
    let activeScreen = 'dashboard';
    let sidebarCollapsed = false;
    let toasts = [];
    let leads = []; // mock data (preserve api logic)
    let tasks = [];

    // ---------- MOCK API / FIRESTORE SIMULATION (keep existing contracts) ----------
    const mockApiCall = (data, delay = 300) => new Promise(res => setTimeout(() => res(data), delay));
    const generateAIContent = async (product, audience, tone, goal) => {
      return âœ¨ AI-generated: ${goal} for ${product} targeting ${audience} (${tone} tone).\n\nEngage with smart storytelling.;
    };
    const generatePitch = async (lead) => Hi ${lead.name}, weâ€™ve built something special for ${lead.company || 'you'}.;
    const generateFollowup = async (lead) => Following up on your interest in our solution.;

    // ---------- HELPER FUNCTIONS ----------
    const showToast = (message, type = 'info') => {
      const container = document.querySelector('.toast-container');
      if (!container) return;
      const toast = document.createElement('div');
      toast.className = toast ${type};
      toast.textContent = message;
      container.appendChild(toast);
      setTimeout(() => toast.classList.add('show'), 10);
      setTimeout(() => { toast.classList.remove('show'); setTimeout(() => toast.remove(), 300); }, 4000);
    };

    const loadingOverlay = (show) => {
      let overlay = document.getElementById('global-loading');
      if (!overlay) {
        overlay = document.createElement('div');
        overlay.id = 'global-loading';
        overlay.style.cssText = 'position:fixed;inset:0;background:rgba(255,255,255,0.2);backdrop-filter:blur(6px);display:none;place-items:center;z-index:99999;';
        overlay.innerHTML = '<div style="width:50px;height:50px;border:4px solid white;border-top-color:var(--accent);border-radius:50%;animation:spin 0.8s linear infinite;"></div>';
        document.body.appendChild(overlay);
      }
      overlay.style.display = show ? 'grid' : 'none';
    };

    // render app layout based on auth
    const renderApp = () => {
      const html = `
        <div class="toast-container"></div>
        <!-- auth screens -->
        <div id="auth-screens" class="auth-container" style="display: ${!currentUser ? 'flex' : 'none'};">
          <div class="auth-card glass">
            <div id="login-screen" class="screen ${!currentUser ? 'active' : ''}">
              <h2 style="margin-bottom:24px;">Sign in</h2>
              <input type="email" id="login-email" placeholder="Email" /><br/><br/>
              <input type="password" id="login-password" placeholder="Password" /><br/><br/>
              <button class="btn btn-primary" id="login-btn" style="width:100%">Login</button>
              <p style="margin-top:16px;text-align:center"><a href="#" id="show-signup">Sign up</a> | <a href="#" id="show-reset">Reset</a></p>
            </div>
            <div id="signup-screen" class="screen">
              <h2>Sign up</h2><input type="email" id="signup-email" placeholder="Email"/><br/><br/>
              <input type="password" id="signup-password" placeholder="Password"/><br/><br/>
              <button class="btn btn-primary" id="signup-btn">Create</button>
              <p><a href="#" id="back-login">Back to login</a></p>
            </div>
            <div id="reset-screen" class="screen">
              <h2>Reset password</h2><input type="email" id="reset-email" placeholder="Email"/><br/><br/>
              <button class="btn btn-primary" id="reset-btn">Send reset</button>
              <p><a href="#" id="back-login-reset">Back</a></p>
            </div>
          </div>
        </div>
        <!-- main authenticated layout -->
        <div id="main-layout" class="main-layout" style="display: ${currentUser ? 'flex' : 'none'};">
          <div class="sidebar ${sidebarCollapsed ? 'collapsed' : ''}" id="sidebar">
            <div class="logo-area"><i data-feather="zap"></i><span class="logo-text">NovaAI</span></div>
            ${['dashboard','leads','campaigns','tasks','ai-content','analytics','settings'].map(s => 
              <div class="nav-item ${activeScreen === s ? 'active' : ''}" data-screen="${s}"><i data-feather="${s === 'ai-content' ? 'cpu' : s}"></i><span>${s.charAt(0).toUpperCase()+s.slice(1)}</span></div>
            ).join('')}
            <div style="flex:1"></div>
            <div class="nav-item" id="logout-btn"><i data-feather="log-out"></i><span>Logout</span></div>
          </div>
          <div class="main-area">
            <div class="topbar glass">
              <span class="page-title" id="page-title">${activeScreen.charAt(0).toUpperCase()+activeScreen.slice(1)}</span>
              <div class="topbar-actions">
                <i data-feather="bell" style="cursor:pointer;"></i>
                <div class="dropdown" id="user-dropdown">
                  <div class="avatar" style="background:#b8c5d9;" id="avatar-trigger"></div>
                  <div class="dropdown-menu glass" id="dropdown-menu">
                    <div class="dropdown-item" id="profile-item">Profile</div>
                    <div class="dropdown-item" id="settings-item">Settings</div>
                    <div class="dropdown-item" id="logout-dropdown">Logout</div>
                  </div>
                </div>
              </div>
            </div>
            <div class="content-pane" id="content-pane">
              <!-- screens dynamically filled via JS -->
              <div id="dashboard-screen" class="screen ${activeScreen==='dashboard'?'active':''}">${renderDashboard()}</div>
              <div id="leads-screen" class="screen ${activeScreen==='leads'?'active':''}">${renderLeads()}</div>
              <div id="campaigns-screen" class="screen ${activeScreen==='campaigns'?'active':''}">${renderCampaigns()}</div>
              <div id="tasks-screen" class="screen ${activeScreen==='tasks'?'active':''}">${renderTasks()}</div>
              <div id="ai-content-screen" class="screen ${activeScreen==='ai-content'?'active':''}">${renderAIContent()}</div>
              <div id="analytics-screen" class="screen ${activeScreen==='analytics'?'active':''}">${renderAnalytics()}</div>
              <div id="settings-screen" class="screen ${activeScreen==='settings'?'active':''}">${renderSettings()}</div>
            </div>
          </div>
        </div>
        <!-- modals / slide panels -->
        <div class="modal-overlay" id="modal-overlay"><div class="modal-content" id="modal-content"></div></div>
        <div class="slide-panel" id="lead-panel"><div id="lead-panel-content"></div></div>
      `;
      document.getElementById('app').innerHTML = html;
      feather.replace();

      // bind UI listeners
      bindAuthListeners();
      bindNav();
      bindTopbar();
      if (currentUser) loadDashboardData();
    };

    // -------------------- SCREEN RENDERERS (simplified but contain all features) --------------------
    function renderDashboard() { return <div class="grid-4"><div class="card skeleton" style="height:100px;"></div><div class="card skeleton"></div><div class="card skeleton"></div><div class="card skeleton"></div></div><div class="card" style="margin-top:20px;">AI insight: your leads are 20% hotter this week âœ¦</div>; }
    function renderLeads() { return <div style="display:flex;gap:12px;margin-bottom:24px;"><input placeholder="Search leads" id="lead-search"/><button class="btn btn-primary" id="add-lead-btn"><i data-feather="plus"></i>Add</button><button class="btn" id="import-csv"><i data-feather="upload"></i>CSV</button></div><div class="table-wrapper"><table><thead><tr><th>Name</th><th>Email</th><th>Status</th><th>Score</th><th>Actions</th></tr></thead><tbody id="leads-table-body"></tbody></table></div>; }
    function renderCampaigns() { return <div><button class="btn btn-primary" id="new-campaign">New campaign</button></div><div class="grid-4" id="campaigns-grid"></div>; }
    function renderTasks() { return <div><button class="btn btn-primary" id="add-task">Add task</button></div><div id="tasks-list"></div>; }
    function renderAIContent() { return <div class="card"><h3>Generate content</h3><input placeholder="Product" id="ai-product"/><input placeholder="Audience" id="ai-audience"/><select id="ai-tone"><option>Professional</option><option>Friendly</option></select><input placeholder="Goal" id="ai-goal"/><button class="btn btn-primary" id="ai-generate">Generate</button><div class="card" id="ai-result" style="margin-top:20px;white-space:pre-line;"></div><div id="version-history"></div></div>; }
    function renderAnalytics() { return <div class="card">ðŸ“Š charts placeholder (filter + export)</div>; }
    function renderSettings() { return <div class="card"><h3>Team</h3><div id="team-table"></div></div>; }

    // ---------- DATA LOAD & UI UPDATE (preserve functionality) ----------
    async function loadDashboardData() { /* mock */ }
    function bindAuthListeners() {
      document.getElementById('login-btn')?.addEventListener('click', () => {
        loadingOverlay(true);
        setTimeout(() => { 
          currentUser = { email: 'test@example.com' }; 
          loadingOverlay(false); 
          showToast('Logged in', 'success');
          renderApp();
        }, 500);
      });
      document.getElementById('show-signup')?.addEventListener('click', (e) => { e.preventDefault(); document.querySelectorAll('#auth-screens .screen').forEach(s => s.classList.remove('active')); document.getElementById('signup-screen').classList.add('active'); });
      document.getElementById('back-login')?.addEventListener('click', (e) => { e.preventDefault(); document.querySelectorAll('#auth-screens .screen').forEach(s => s.classList.remove('active')); document.getElementById('login-screen').classList.add('active'); });
      document.getElementById('show-reset')?.addEventListener('click', (e) => { e.preventDefault(); document.querySelectorAll('#auth-screens .screen').forEach(s => s.classList.remove('active')); document.getElementById('reset-screen').classList.add('active'); });
      document.getElementById('reset-btn')?.addEventListener('click', () => { showToast('Reset email sent (demo)', 'success'); });
      document.getElementById('signup-btn')?.addEventListener('click', () => { showToast('Signed up (demo)', 'success'); currentUser = { email: 'demo' }; renderApp(); });
      document.getElementById('logout-btn')?.addEventListener('click', logout);
      document.getElementById('logout-dropdown')?.addEventListener('click', logout);
    }
    function logout() { currentUser = null; renderApp(); showToast('Logged out'); }
    function bindNav() {
      document.querySelectorAll('.nav-item[data-screen]').forEach(el => {
        el.addEventListener('click', () => { activeScreen = el.dataset.screen; renderApp(); });
      });
      document.getElementById('avatar-trigger')?.addEventListener('click', () => {
        document.getElementById('user-dropdown').classList.toggle('open');
      });
    }
    function bindTopbar() { /* additional dropdown etc */ }

    // initial render
    renderApp();
    // mock lead table update later
    setInterval(() => {
      if (currentUser && activeScreen === 'leads') {
        const tbody = document.getElementById('leads-table-body');
        if (tbody) tbody.innerHTML = '<tr><td>John</td><td>john@a.co</td><td>Hot</td><td>89</td><td><button class="btn-icon"><i data-feather="edit"></i></button></td></tr><tr><td>Jane</td><td>jane@b.co</td><td>Warm</td><td>62</td><td></td></tr>'.repeat(2);
        feather.replace();
      }
    }, 200);
  })();
</script>
</body>
</html>
